<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Pits and spikes filling — pit_fill • lasR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pits and spikes filling — pit_fill"><meta name="description" content="Pits and spikes filling for raster. Typically used for post-processing CHM. This algorithm
is from St-Onge 2008 (see reference)."><meta property="og:description" content="Pits and spikes filling for raster. Typically used for post-processing CHM. This algorithm
is from St-Onge 2008 (see reference)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lasR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Presentation</h6></li>
    <li><a class="dropdown-item" href="../articles/why.html">Why lasR?</a></li>
    <li><a class="dropdown-item" href="../articles/benchmarks.html">Benchmarks of lasR vs. lidR</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/tutorial.html">Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/multithreading.html">Parallel processing</a></li>
    <li><a class="dropdown-item" href="../articles/r-stages.html">R stages</a></li>
    <li><a class="dropdown-item" href="../articles/baba.html">Buffered Area Based Approach</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lidar/lasR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Pits and spikes filling</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lidar/lasR/blob/main/R/stages.R" class="external-link"><code>R/stages.R</code></a></small>
      <div class="d-none name"><code>pit_fill.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Pits and spikes filling for raster. Typically used for post-processing CHM. This algorithm
is from St-Onge 2008 (see reference).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pit_fill</span><span class="op">(</span></span>
<span>  <span class="va">raster</span>,</span>
<span>  lap_size <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  thr_lap <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  thr_spk <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>,</span>
<span>  med_size <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  dil_radius <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  ofile <span class="op">=</span> <span class="fu"><a href="temporary_files.html">temptif</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-raster">raster<a class="anchor" aria-label="anchor" href="#arg-raster"></a></dt>
<dd><p>LASRalgorithm. A stage that produces a raster.</p></dd>


<dt id="arg-lap-size">lap_size<a class="anchor" aria-label="anchor" href="#arg-lap-size"></a></dt>
<dd><p>integer. Size of the Laplacian filter kernel (integer value, in pixels).</p></dd>


<dt id="arg-thr-lap">thr_lap<a class="anchor" aria-label="anchor" href="#arg-thr-lap"></a></dt>
<dd><p>numeric. Threshold Laplacian value for detecting a cavity (all values above this
value will be considered a cavity). A positive value.</p></dd>


<dt id="arg-thr-spk">thr_spk<a class="anchor" aria-label="anchor" href="#arg-thr-spk"></a></dt>
<dd><p>numeric. Threshold Laplacian value for detecting a spike (all values below this
value will be considered a spike). A negative value.</p></dd>


<dt id="arg-med-size">med_size<a class="anchor" aria-label="anchor" href="#arg-med-size"></a></dt>
<dd><p>integer. Size of the median filter kernel (integer value, in pixels).</p></dd>


<dt id="arg-dil-radius">dil_radius<a class="anchor" aria-label="anchor" href="#arg-dil-radius"></a></dt>
<dd><p>integer. Dilation radius (integer value, in pixels).</p></dd>


<dt id="arg-ofile">ofile<a class="anchor" aria-label="anchor" href="#arg-ofile"></a></dt>
<dd><p>character. Full outputs are always stored on disk. If <code>ofile = ""</code>
then the stage will not store the result on disk and will return nothing. It will however
hold partial output results temporarily in memory. This is useful for stage that are only
intermediate stage.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This stage produces a raster. The path provided to `ofile` is expected to be `.tif` or any
other format supported by GDAL.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>St-Onge, B., 2008. Methods for improving the quality of a true orthomosaic of Vexcel UltraCam
images created using alidar digital surface model, Proceedings of the Silvilaser 2008, Edinburgh,
555-562. https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=81365288221f3ac34b51a82e2cfed8d58defb10e</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"MixedConifer.las"</span>, package<span class="op">=</span><span class="st">"lasR"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">reader</span> <span class="op">&lt;-</span> <span class="fu"><a href="reader_las.html">reader_las</a></span><span class="op">(</span>filter <span class="op">=</span> <span class="fu"><a href="filters.html">keep_first</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tri</span> <span class="op">&lt;-</span> <span class="fu"><a href="triangulate.html">triangulate</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chm</span> <span class="op">&lt;-</span> <span class="fu"><a href="rasterize.html">rasterize</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="va">tri</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pit</span> <span class="op">&lt;-</span> <span class="fu">pit_fill</span><span class="op">(</span><span class="va">chm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="exec.html">exec</a></span><span class="op">(</span><span class="va">reader</span> <span class="op">+</span> <span class="va">tri</span> <span class="op">+</span> <span class="va">chm</span> <span class="op">+</span> <span class="va">pit</span>, on <span class="op">=</span> <span class="va">f</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">chm</span> <span class="op">&lt;-</span> <span class="va">u</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">sto</span> <span class="op">&lt;-</span> <span class="va">u</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#terra::plot(c(chm, sto), col = lidR::height.colors(25))</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jean-Romain Roussel.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

